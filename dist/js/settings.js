"use strict";window.addEventListener("load",function(){db_readMultiData(function(r){SETTINGS=r[0];settingDetails(SETTINGS)},"settings",console.log);closeListener()});function settingDetails(results){var i;var SETTINGS=results;var vertNoten=SETTINGS.notenverteilung;var inputs1=document.getElementById("form_Notenverteilung").getElementsByTagName("input");for(i=0;i<inputs1.length;i++){if(i+1==6){inputs1[i].value=0}else{inputs1[i].value=vertNoten[i+1]}}var inputs2=document.getElementById("form_KompNamen").getElementsByTagName("input");for(i=0;i<inputs2.length;i++){inputs2[i].value=SETTINGS.kompetenzen["Kat"+(i+1)]||""}var Gewichtung=SETTINGS.gewichtung;i=0;var labels=document.getElementById("form_Gewichtung").getElementsByTagName("label");var inputs3=document.getElementById("form_Gewichtung").getElementsByTagName("input");for(var e in Gewichtung){labels[i].childNodes[0].textContent=e+" ";inputs3[i].value=Gewichtung[e]*100;i++}document.form_fspz.differenziert.checked=SETTINGS.fspzDiff;document.form_sex.stud_Sort.checked=SETTINGS.studSort;var a_button=document.getElementById("alle_gruppieren").getElementsByTagName("a")[0];a_button.addEventListener("click",function(){db_readMultiData(function(result){var btn_abort=document.getElementById("Abbrechen");btn_abort.innerHTML=btn_abort.innerHTML.replace("Reset","Abbrechen");document.getElementById("Save").onclick=function(){saveGruppen()};document.getElementById("item1setting").classList.remove("show");popUp("item1setting_info");gruppierenListe(result)},"student")});slide1("item1setting")}function SettingsSave(bol_save){var inputs,i;var settings=SETTINGS;if(bol_save){inputs=document.getElementById("form_Gewichtung").getElementsByTagName("input");settings.gewichtung={"m\xFCndlich":inputs[0].value/100,"davon fachspezifisch":inputs[1].value/100,"schriftlich":inputs[2].value/100};inputs=document.getElementById("form_Notenverteilung").getElementsByTagName("input");settings.notenverteilung={};for(i=0;i<inputs.length;i++){settings.notenverteilung[i+1]=parseInt(inputs[i].value)}inputs=document.getElementById("form_KompNamen").getElementsByTagName("input");settings.kompetenzen={};settings.kompetenzen["Gesamt"]="Gesamt";for(i=0;i<inputs.length;i++){settings.kompetenzen["Kat"+(i+1)]=inputs[i].value||"Kategorie "+(i+1)}settings.fspzDiff=document.form_fspz.differenziert.checked;settings.studSort=document.form_sex.stud_Sort.checked;settings.showVorjahr=false;db_replaceData(function(){SETTINGS=settings;handleSchnitt(function(){slide1("item1setting","uebersicht.htm")})},settings,GLOBALS.klasse)}}function gruppierenListe(results){var r,c,liste,ul;results.sort(compareStudents);liste=document.getElementById("gruppierenListe");ul=document.createElement("ul");for(var i in results){var row=results[i];r=document.createElement("li");if(row.name.sort&&row.name.sort!=="-"&&row.name.sort!=="null"){c=document.createElement("div");c.className="s_flag";c.innerHTML=row.name.sort;r.appendChild(c)}r.setAttribute("data-rowid",row.id);c=document.createElement("div");c.className="name";c.innerHTML=row.name.nname+", "+row.name.vname;r.appendChild(c);ul.appendChild(r);r.addEventListener("click",function(){if(this.classList.contains("selected")){this.classList.remove("selected")}else{this.classList.add("selected")}})}liste.appendChild(ul);slide1("item1setting_gruppen");return true}function saveGruppen(){var gruppe=document.getElementById("gruppierer").value;var liste=document.getElementsByClassName("selected");var student,i;var newObjects={};for(i=0;i<liste.length;i++){student=liste[i].getAttribute("data-rowid");newObjects[student]={"name":{"sort":gruppe,"changed":timestamp()}}}db_updateData(function(){slide1("item1setting_gruppen","uebersicht.htm")},newObjects);return true}